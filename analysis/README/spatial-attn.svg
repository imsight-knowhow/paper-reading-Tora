<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.1.0 (20250701.0955)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1185pt" height="314pt"
 viewBox="0.00 0.00 1185.00 314.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(14.4 299.65)">
<title>G</title>
<polygon fill="white" stroke="none" points="-14.4,14.4 -14.4,-299.65 1170.15,-299.65 1170.15,14.4 -14.4,14.4"/>
<text xml:space="preserve" text-anchor="middle" x="577.88" y="-271.75" font-family="Times New Roman,serif" font-size="10.00">Spatial Self&#45;Attention (ST&#45;DiT) — From Patchify to Attention</text>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="#7f8c8d" stroke-dasharray="5,2" points="8,-122 8,-193 603.25,-193 603.25,-122 8,-122"/>
<text xml:space="preserve" text-anchor="middle" x="305.62" y="-179.5" font-family="Times New Roman,serif" font-size="10.00">Tokenization</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_frames</title>
<path fill="none" stroke="#34495e" d="M649,-57C649,-57 807.5,-57 807.5,-57 813.5,-57 819.5,-63 819.5,-69 819.5,-69 819.5,-246 819.5,-246 819.5,-252 813.5,-258 807.5,-258 807.5,-258 649,-258 649,-258 643,-258 637,-252 637,-246 637,-246 637,-69 637,-69 637,-63 643,-57 649,-57"/>
<text xml:space="preserve" text-anchor="middle" x="728.25" y="-244.5" font-family="Times New Roman,serif" font-size="10.00">Per&#45;frame spatial tokens (flattened H&#39;·W&#39;)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_attn</title>
<path fill="none" stroke="#2c3e50" d="M864.25,-71C864.25,-71 1135.75,-71 1135.75,-71 1141.75,-71 1147.75,-77 1147.75,-83 1147.75,-83 1147.75,-136 1147.75,-136 1147.75,-142 1141.75,-148 1135.75,-148 1135.75,-148 864.25,-148 864.25,-148 858.25,-148 852.25,-142 852.25,-136 852.25,-136 852.25,-83 852.25,-83 852.25,-77 858.25,-71 864.25,-71"/>
<text xml:space="preserve" text-anchor="middle" x="1000" y="-134.5" font-family="Times New Roman,serif" font-size="10.00">Spatial Self&#45;Attention</text>
</g>
<!-- video -->
<g id="node1" class="node">
<title>video</title>
<polygon fill="none" stroke="black" points="135.5,-166 132.5,-170 111.5,-170 108.5,-166 16,-166 16,-130 135.5,-130 135.5,-166"/>
<text xml:space="preserve" text-anchor="middle" x="75.75" y="-144.12" font-family="Times New Roman,serif" font-size="10.00">Video frames (F x H x W)</text>
</g>
<!-- vae -->
<g id="node2" class="node">
<title>vae</title>
<path fill="none" stroke="black" d="M264.75,-166C264.75,-166 183.5,-166 183.5,-166 177.5,-166 171.5,-160 171.5,-154 171.5,-154 171.5,-142 171.5,-142 171.5,-136 177.5,-130 183.5,-130 183.5,-130 264.75,-130 264.75,-130 270.75,-130 276.75,-136 276.75,-142 276.75,-142 276.75,-154 276.75,-154 276.75,-160 270.75,-166 264.75,-166"/>
<text xml:space="preserve" text-anchor="middle" x="224.12" y="-149.75" font-family="Times New Roman,serif" font-size="10.00">Video VAE (optional)</text>
<text xml:space="preserve" text-anchor="middle" x="224.12" y="-138.5" font-family="Times New Roman,serif" font-size="10.00">compress to latents</text>
</g>
<!-- video&#45;&gt;vae -->
<g id="edge1" class="edge">
<title>video&#45;&gt;vae</title>
<path fill="none" stroke="black" d="M135.86,-148C144.76,-148 153.95,-148 162.87,-148"/>
<polygon fill="black" stroke="black" points="162.82,-150.45 169.82,-148 162.82,-145.55 162.82,-150.45"/>
</g>
<!-- latents -->
<g id="node3" class="node">
<title>latents</title>
<path fill="none" stroke="black" d="M424.75,-166C424.75,-166 324.75,-166 324.75,-166 318.75,-166 312.75,-160 312.75,-154 312.75,-154 312.75,-142 312.75,-142 312.75,-136 318.75,-130 324.75,-130 324.75,-130 424.75,-130 424.75,-130 430.75,-130 436.75,-136 436.75,-142 436.75,-142 436.75,-154 436.75,-154 436.75,-160 430.75,-166 424.75,-166"/>
<text xml:space="preserve" text-anchor="middle" x="374.75" y="-144.12" font-family="Times New Roman,serif" font-size="10.00">Latent frames (F x H&#39; x W&#39;)</text>
</g>
<!-- vae&#45;&gt;latents -->
<g id="edge2" class="edge">
<title>vae&#45;&gt;latents</title>
<path fill="none" stroke="black" d="M277.11,-148C285.82,-148 294.99,-148 304.07,-148"/>
<polygon fill="black" stroke="black" points="303.85,-150.45 310.85,-148 303.85,-145.55 303.85,-150.45"/>
</g>
<!-- patchify -->
<g id="node4" class="node">
<title>patchify</title>
<path fill="none" stroke="black" d="M583.25,-166C583.25,-166 484.75,-166 484.75,-166 478.75,-166 472.75,-160 472.75,-154 472.75,-154 472.75,-142 472.75,-142 472.75,-136 478.75,-130 484.75,-130 484.75,-130 583.25,-130 583.25,-130 589.25,-130 595.25,-136 595.25,-142 595.25,-142 595.25,-154 595.25,-154 595.25,-160 589.25,-166 583.25,-166"/>
<text xml:space="preserve" text-anchor="middle" x="534" y="-149.75" font-family="Times New Roman,serif" font-size="10.00">2D Patchify per frame</text>
<text xml:space="preserve" text-anchor="middle" x="534" y="-138.5" font-family="Times New Roman,serif" font-size="10.00">+ 2D Positional Encoding</text>
</g>
<!-- latents&#45;&gt;patchify -->
<g id="edge3" class="edge">
<title>latents&#45;&gt;patchify</title>
<path fill="none" stroke="black" d="M437,-148C445.91,-148 455.14,-148 464.19,-148"/>
<polygon fill="black" stroke="black" points="463.92,-150.45 470.92,-148 463.92,-145.55 463.92,-150.45"/>
</g>
<!-- f1 -->
<g id="node5" class="node">
<title>f1</title>
<path fill="#ffffff" stroke="black" d="M774,-101C774,-101 681.5,-101 681.5,-101 675.5,-101 669.5,-95 669.5,-89 669.5,-89 669.5,-77 669.5,-77 669.5,-71 675.5,-65 681.5,-65 681.5,-65 774,-65 774,-65 780,-65 786,-71 786,-77 786,-77 786,-89 786,-89 786,-95 780,-101 774,-101"/>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-84.75" font-family="Times New Roman,serif" font-size="10.00">Frame t=1 tokens:</text>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-73.5" font-family="Times New Roman,serif" font-size="10.00">{x_1, x_2, ..., x_{H&#39;W&#39;}}</text>
</g>
<!-- patchify&#45;&gt;f1 -->
<g id="edge5" class="edge">
<title>patchify&#45;&gt;f1</title>
<path fill="none" stroke="black" d="M589.43,-129.55C601.84,-125.34 615.39,-120.75 629,-116.14"/>
<polygon fill="black" stroke="black" points="629.73,-118.48 635.57,-113.91 628.15,-113.84 629.73,-118.48"/>
</g>
<!-- f2 -->
<g id="node6" class="node">
<title>f2</title>
<path fill="#ffffff" stroke="black" d="M774,-166C774,-166 681.5,-166 681.5,-166 675.5,-166 669.5,-160 669.5,-154 669.5,-154 669.5,-142 669.5,-142 669.5,-136 675.5,-130 681.5,-130 681.5,-130 774,-130 774,-130 780,-130 786,-136 786,-142 786,-142 786,-154 786,-154 786,-160 780,-166 774,-166"/>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-149.75" font-family="Times New Roman,serif" font-size="10.00">Frame t=2 tokens:</text>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-138.5" font-family="Times New Roman,serif" font-size="10.00">{x_1, x_2, ..., x_{H&#39;W&#39;}}</text>
</g>
<!-- patchify&#45;&gt;f2 -->
<g id="edge6" class="edge">
<title>patchify&#45;&gt;f2</title>
<path fill="none" stroke="black" d="M595.67,-148C606.25,-148 617.5,-148 628.79,-148"/>
<polygon fill="black" stroke="black" points="628.49,-150.45 635.49,-148 628.49,-145.55 628.49,-150.45"/>
</g>
<!-- f3 -->
<g id="node7" class="node">
<title>f3</title>
<path fill="#ffffff" stroke="black" d="M774,-231C774,-231 681.5,-231 681.5,-231 675.5,-231 669.5,-225 669.5,-219 669.5,-219 669.5,-207 669.5,-207 669.5,-201 675.5,-195 681.5,-195 681.5,-195 774,-195 774,-195 780,-195 786,-201 786,-207 786,-207 786,-219 786,-219 786,-225 780,-231 774,-231"/>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-214.75" font-family="Times New Roman,serif" font-size="10.00">Frame t=T tokens:</text>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-203.5" font-family="Times New Roman,serif" font-size="10.00">{x_1, x_2, ..., x_{H&#39;W&#39;}}</text>
</g>
<!-- patchify&#45;&gt;f3 -->
<g id="edge7" class="edge">
<title>patchify&#45;&gt;f3</title>
<path fill="none" stroke="black" d="M588.69,-166.48C600.6,-170.56 613.28,-174.9 629.02,-180.24"/>
<polygon fill="black" stroke="black" points="628.15,-182.53 635.57,-182.46 629.73,-177.89 628.15,-182.53"/>
</g>
<!-- spat_attn -->
<g id="node8" class="node">
<title>spat_attn</title>
<path fill="#eef7ff" stroke="black" d="M971.5,-120.88C971.5,-120.88 872.25,-120.88 872.25,-120.88 866.25,-120.88 860.25,-114.88 860.25,-108.88 860.25,-108.88 860.25,-91.12 860.25,-91.12 860.25,-85.12 866.25,-79.12 872.25,-79.12 872.25,-79.12 971.5,-79.12 971.5,-79.12 977.5,-79.12 983.5,-85.12 983.5,-91.12 983.5,-91.12 983.5,-108.88 983.5,-108.88 983.5,-114.88 977.5,-120.88 971.5,-120.88"/>
<text xml:space="preserve" text-anchor="middle" x="921.88" y="-107.38" font-family="Times New Roman,serif" font-size="10.00">Spatial Self&#45;Attention</text>
<text xml:space="preserve" text-anchor="middle" x="921.88" y="-96.12" font-family="Times New Roman,serif" font-size="10.00">(2D within each frame)</text>
<text xml:space="preserve" text-anchor="middle" x="921.88" y="-84.88" font-family="Times New Roman,serif" font-size="10.00">mask: none (bidirectional)</text>
</g>
<!-- f1&#45;&gt;spat_attn -->
<g id="edge8" class="edge">
<title>f1&#45;&gt;spat_attn</title>
<path fill="none" stroke="black" d="M819.5,-91.03C830.27,-91.98 841.13,-92.94 851.54,-93.86"/>
<polygon fill="black" stroke="black" points="851.24,-96.3 858.43,-94.47 851.67,-91.42 851.24,-96.3"/>
</g>
<!-- f2&#45;&gt;spat_attn -->
<g id="edge9" class="edge">
<title>f2&#45;&gt;spat_attn</title>
<path fill="none" stroke="black" d="M819.5,-125.33C830.37,-122.61 841.33,-119.87 851.82,-117.25"/>
<polygon fill="black" stroke="black" points="852.27,-119.67 858.46,-115.59 851.08,-114.91 852.27,-119.67"/>
</g>
<!-- f3&#45;&gt;spat_attn -->
<g id="edge10" class="edge">
<title>f3&#45;&gt;spat_attn</title>
<path fill="none" stroke="black" d="M819.5,-183.56C821.11,-182.73 822.69,-181.87 824.25,-181 850.33,-166.39 876.08,-144.32 894.43,-126.9"/>
<polygon fill="black" stroke="black" points="895.93,-128.86 899.27,-122.24 892.53,-125.33 895.93,-128.86"/>
</g>
<!-- out_tokens -->
<g id="node9" class="node">
<title>out_tokens</title>
<path fill="none" stroke="black" d="M1127.75,-118C1127.75,-118 1031.5,-118 1031.5,-118 1025.5,-118 1019.5,-112 1019.5,-106 1019.5,-106 1019.5,-94 1019.5,-94 1019.5,-88 1025.5,-82 1031.5,-82 1031.5,-82 1127.75,-82 1127.75,-82 1133.75,-82 1139.75,-88 1139.75,-94 1139.75,-94 1139.75,-106 1139.75,-106 1139.75,-112 1133.75,-118 1127.75,-118"/>
<text xml:space="preserve" text-anchor="middle" x="1079.62" y="-101.75" font-family="Times New Roman,serif" font-size="10.00">Updated tokens per frame</text>
<text xml:space="preserve" text-anchor="middle" x="1079.62" y="-90.5" font-family="Times New Roman,serif" font-size="10.00">(ready for next block)</text>
</g>
<!-- spat_attn&#45;&gt;out_tokens -->
<g id="edge4" class="edge">
<title>spat_attn&#45;&gt;out_tokens</title>
<path fill="none" stroke="black" d="M983.98,-100C992.77,-100 1001.85,-100 1010.75,-100"/>
<polygon fill="black" stroke="black" points="1010.71,-102.45 1017.71,-100 1010.71,-97.55 1010.71,-102.45"/>
</g>
<!-- note -->
<g id="node10" class="node">
<title>note</title>
<polygon fill="none" stroke="black" points="818.25,-36 631.25,-36 631.25,0 824.25,0 824.25,-30 818.25,-36"/>
<polyline fill="none" stroke="black" points="818.25,-36 818.25,-30"/>
<polyline fill="none" stroke="black" points="824.25,-30 818.25,-30"/>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-19.95" font-family="Times New Roman,serif" font-size="9.00">In 2+1D ST&#45;DiT, spatial self&#45;attention</text>
<text xml:space="preserve" text-anchor="middle" x="727.75" y="-9.45" font-family="Times New Roman,serif" font-size="9.00">operates over tokens within each frame in parallel.</text>
</g>
<!-- note&#45;&gt;spat_attn -->
</g>
</svg>
